---
export interface Props {
  title: string;
  description: string;
  image?: {
    url: string;
    alt: string;
  };
  type?: "website" | "article";
  canonicalUrl?: string;
}

const {
  title,
  description,
  image = {
    url: "/images/og/ecea-og.png",
    alt: "ECEA - East Coast Enduro Association",
  },
  type = "website",
  canonicalUrl,
} = Astro.props;

// Get the canonical URL
const canonicalURL = canonicalUrl || new URL(Astro.url.pathname, Astro.site);

// ECEA Organization info
const orgInfo = {
  name: "East Coast Enduro Association",
  shortName: "ECEA",
  description: "AMA sanctioned off-road motorcycle racing organization",
  url: Astro.site?.toString() || "https://ecea.org",
  email: "info@ecea.org",
  foundingDate: "1971",
};
---

<!-- Basic SEO -->
<title>{title}</title>
<meta name="description" content={description} />
<link rel="canonical" href={canonicalURL} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={canonicalURL} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={new URL(image.url, Astro.site)} />
<meta property="og:image:alt" content={image.alt} />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content={canonicalURL} />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />
<meta property="twitter:image" content={new URL(image.url, Astro.site)} />
<meta property="twitter:image:alt" content={image.alt} />

<!-- JSON-LD Schema for Sports Organization -->
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SportsOrganization",
    "name": "${orgInfo.name}",
    "alternateName": "${orgInfo.shortName}",
    "description": "${orgInfo.description}",
    "email": "${orgInfo.email}",
    "url": "${orgInfo.url}",
    "foundingDate": "${orgInfo.foundingDate}",
    "sport": "Motorcycle Racing"
  }
</script>

{
  type === "article" && (
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "${title}",
        "image": "${new URL(image.url, Astro.site)}",
        "description": "${description}",
        "publisher": {
          "@type": "Organization",
          "name": "${orgInfo.name}",
          "logo": {
            "@type": "ImageObject",
            "url": "${new URL("/images/og/ecea-og.png", Astro.site)}"
          }
        },
        "url": "${canonicalURL}",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "${canonicalURL}"
        }
      }
    </script>
  )
}
